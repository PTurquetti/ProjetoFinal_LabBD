SELECT DISTINCT
    C.NOME AS COMUNIDADE,
    C.ESPECIE AS ESPECIE,
    E.PLANETA_OR AS PLANETA_ORIGEM,
    E.INTELIGENTE AS INTELIGENTE,
    P.FACCAO AS FACCAO,
    H.PLANETA AS PLANETA_HABITADO,
    S.NOME AS SISTEMA,
    H.DATA_INI AS INICIO_HABITACAO,
    H.DATA_FIM AS FIM_HABITACAO
FROM
    PARTICIPA P 
    JOIN COMUNIDADE C ON C.ESPECIE = P.ESPECIE AND C.NOME = P.COMUNIDADE
    JOIN HABITACAO H ON H.ESPECIE = C.ESPECIE AND H.COMUNIDADE = C.NOME
    JOIN ESPECIE E ON E.NOME = C.ESPECIE
    JOIN ORBITA_PLANETA OP ON OP.PLANETA = H.PLANETA
    JOIN SISTEMA S ON S.ESTRELA = OP.ESTRELA
ORDER BY 
    C.NOME, C.ESPECIE, P.FACCAO, H.PLANETA, H.DATA_INI, H.DATA_FIM;
